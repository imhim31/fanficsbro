<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fanfics</title>
  <link rel="icon" href="https://cdn.glitch.global/381f1ea9-3b68-4215-8c0b-5811be8e5192/a.PNG?v=1731478429002" type="image/icon type">
  
  <style>
  body {
    background-color:#ff9ed4;
  }

  .background{
    background-color: rgba(247, 77, 171);
    color: white;
    font-family:verdana;
    border-style: dashed;
    border-color:white; 
    padding: 2%;
  }
  .h1background{
    background-color:rgba(247, 77, 171);
    color: white;
  }
  .footer{
    position: absolute;
    bottom:0.02;
  }
  .xd{
    position:relative;
    top:2.5%;
    height:19px;
    background-size: cover;
    background-color: rgba(204, 204, 204, 0);
  }
  .emojiDiv {
    display: flex;
  }
  *{
    cursor: url(https://ani.cursors-4u.net/smiley/smi-3/smi310.cur), auto !important;
  }
  a:link, a:visited, button {
    color:#f74dab;
    background-image: url('https://i.pinimg.com/564x/fa/df/76/fadf76666e257d5a2d0375f96f791159.jpg');
    text-decoration: none;
    background-size: 100% 100%;
    cursor: url(https://ani.cursors-4u.net/smiley/smi-3/smi283.cur), auto !important;
  }

  /* Form styles */
  #addEntryForm {
    background-color:#f74dab; 
    padding:10px; 
    border-radius:10px;
    margin-bottom:20px;
  }
  #addEntryForm input, #addEntryForm select, #addEntryForm button {
    display:block; 
    margin:5px 0; 
    padding:5px;
    font-size: 16px;
  }
  </style>
</head>

<body>

<h1 class="h1background">Can read again</h1>
<div class="emojiDiv" id="canReadAgain"></div>

<br><br>
<h1 class="h1background">Shorties</h1>
<div class="emojiDiv" id="shorties"></div>

<br><br>
<h1 class="h1background">Not rlly worth reading again</h1>
<div class="emojiDiv" id="notWorthReading"></div>

<br><br>
<h2>Add a New Entry</h2>
<form id="addEntryForm">
  <select name="category" required>
    <option value="">Select Category</option>
    <option value="canReadAgain">Can Read Again</option>
    <option value="shorties">Shorties</option>
    <option value="notWorthReading">Not Worth Reading</option>
  </select>
  <input name="title" placeholder="Title" required>
  <input name="description" placeholder="Description" required>
  <input name="link" placeholder="Link (optional)">
  <button type="submit">Add Entry</button>
</form>

<br><br>
<button onclick="document.location='/emojis.html'" style="background-color: #ff8f0f;
border: 2px solid  #f74dab; font-size:200%; "> Emojis </button>
<button onclick="document.location='/comments.html'" style="background-color: #ff8f0f;
border: 2px solid  #f74dab; font-size:200%;"> Comments </button>

<br><br>
<div class="footer">
  <img class="footimg" src="https://cdn.glitch.global/381f1ea9-3b68-4215-8c0b-5811be8e5192/b.png?v=1731478434939" alt="" width="30%" height="30%">
  <img src="https://cdn.glitch.global/381f1ea9-3b68-4215-8c0b-5811be8e5192/b.png?v=1731478434939" alt="" width="30%" height="30%">
  <img src="https://cdn.glitch.global/381f1ea9-3b68-4215-8c0b-5811be8e5192/b.png?v=1731478434939" alt="" width="30%" height="30%">
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDLmVWE3eIbHFqqnpN5bGygjZUf8kB5HeE",
  authDomain: "fanfics-2f495.firebaseapp.com",
  projectId: "fanfics-2f495",
  storageBucket: "fanfics-2f495.firebasestorage.app",
  messagingSenderId: "634198499413",
  appId: "1:634198499413:web:fa1bb662798a35e70934dc"
};

// Initialize Firebase (compat)
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Example: test reading from Firestore
db.collection("entries").get().then(snapshot => {
  snapshot.forEach(doc => {
    console.log(doc.id, doc.data());
  });
});
</script>

  <script>
// ====== DYNAMIC FIREBASE ENTRIES WITH DEBUGGING ======
const form = document.getElementById('addEntryForm');
const sections = {
  canReadAgain: document.getElementById('canReadAgain'),
  shorties: document.getElementById('shorties'),
  notWorthReading: document.getElementById('notWorthReading')
};

// Function to render entries on page
function renderEntries(snapshot) {
  for (let s in sections) sections[s].innerHTML = '';
  snapshot.forEach(doc => {
    const e = doc.data();
    console.log('Rendering entry:', e); // Debug log
    if (e.category && sections[e.category]) {
      sections[e.category].innerHTML += `
        <p class="background">
          -${e.title} (${e.description})
          ${e.link ? `<a class="emoji">star</a><a target="_blank" href="${e.link}">link</a><a class="emoji">star</a>` : ""}
        </p>`;
    }
  });
}

// Real-time listener
db.collection('entries').onSnapshot(snapshot => {
  console.log('Snapshot received:', snapshot.docs.length); // Debug log
  renderEntries(snapshot);
});

// Handle new entries
form.addEventListener('submit', async e => {
  e.preventDefault();
  const f = e.target;
  
  // Make sure a category is selected
  if (!f.category.value) {
    alert('Please select a category!');
    return;
  }
  
  const newEntry = {
    category: f.category.value,
    title: f.title.value.trim(),
    description: f.description.value.trim(),
    link: f.link.value.trim()
  };
  
  console.log('Adding entry:', newEntry); // Debug log
  
  try {
    await db.collection('entries').add(newEntry);
    console.log('Entry added successfully!');
    f.reset();
  } catch (err) {
    console.error('Error adding entry:', err);
  }
});
</script>


</body>
</html>
